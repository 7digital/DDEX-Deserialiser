using System.IO;
using System.Xml.Linq;
using System.Xml.Schema;
using DDEX_Deserialiser.AutoGenerated;
using DDEX_Deserialiser.Utils;

namespace DDEX_Deserialiser
{
	public class DDEX
	{
		public NewReleaseMessage Root { get; private set; }

		public DDEX(string sourceFilePath, bool verifySchema = false)
			: this(XDocument.Load(sourceFilePath, LoadOptions.SetLineInfo | LoadOptions.PreserveWhitespace), verifySchema)
		{
		}

		public DDEX(Stream stream, bool verifySchema = false)
			: this(XDocument.Load(stream, LoadOptions.SetLineInfo | LoadOptions.PreserveWhitespace), verifySchema)
		{
		}

		public DDEX(XDocument doc, bool verifySchema = false)
		{
			if (verifySchema)
				doc.Validate(DDEXSchema.GetDdexSchema(), null);

			Root = new NewReleaseMessage(doc.Root);
		}
	}
}
